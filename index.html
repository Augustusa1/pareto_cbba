<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard de Costos por Departamento</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        #chartModal {
            display: none; /* Hidden by default */
        }
        /* Sidebar transition */
        #sidebar {
            transition: transform 0.3s ease-in-out;
        }
        .kpi-value {
            line-height: 1.1;
        }
    </style>
</head>
<body class="bg-gray-100">

    <div class="relative min-h-screen md:flex">
        <!-- Mobile menu button -->
        <div class="bg-gray-800 text-gray-100 flex justify-between md:hidden">
            <a href="#" class="block p-4 text-white font-bold">Departamentos</a>
            <button id="mobile-menu-button" class="p-4 focus:outline-none focus:bg-gray-700">
                <svg class="h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7" />
                </svg>
            </button>
        </div>

        <!-- Sidebar -->
        <aside id="sidebar" class="bg-gray-800 text-white w-64 space-y-6 py-7 px-2 absolute inset-y-0 left-0 transform -translate-x-full md:relative md:translate-x-0 transition duration-200 ease-in-out z-20">
            <a href="#" class="text-white flex items-center space-x-2 px-4">
                <svg class="w-8 h-8" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"></path></svg>
                <span class="text-2xl font-extrabold">Dashboard</span>
            </a>
            <nav id="department-nav">
                 <a href="#" class="nav-link block py-2.5 px-4 rounded transition duration-200 hover:bg-gray-700" data-dept="nacional">
                   Nacional
                </a>
                <a href="#" class="nav-link block py-2.5 px-4 rounded transition duration-200 hover:bg-gray-700" data-dept="cbba">
                   Cochabamba
                </a>
                <a href="#" class="nav-link block py-2.5 px-4 rounded transition duration-200 hover:bg-gray-700" data-dept="scz">
                   Santa Cruz
                </a>
                <a href="#" class="nav-link block py-2.5 px-4 rounded transition duration-200 hover:bg-gray-700" data-dept="sucre">
                   Sucre
                </a>
                <a href="#" class="nav-link block py-2.5 px-4 rounded transition duration-200 hover:bg-gray-700" data-dept="trinidad">
                   Trinidad
                </a>
                 <a href="#" class="nav-link block py-2.5 px-4 rounded transition duration-200 hover:bg-gray-700" data-dept="lpz">
                   La Paz
                </a>
                <!-- Add new departments here -->
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="flex-1 p-4 sm:p-6 lg:p-8 overflow-y-auto">
            <div id="content-area">
                <!-- Department content will be loaded here -->
            </div>
        </main>
    </div>

    <!-- Modal para el Gráfico Ampliado -->
    <div id="chartModal" class="fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center p-4 z-50">
        <div class="bg-white p-6 rounded-lg shadow-xl w-full max-w-6xl h-full max-h-[90vh] relative flex flex-col">
            <div class="flex justify-between items-center mb-4">
                 <h3 id="modalTitle" class="text-2xl font-semibold">Gráfico Ampliado</h3>
                 <button id="closeModalBtn" class="text-gray-600 hover:text-gray-900 text-3xl font-bold">&times;</button>
            </div>
            <div class="flex-grow h-full">
                <canvas id="modalChartCanvas"></canvas>
            </div>
        </div>
    </div>


    <script>
        Chart.register(ChartDataLabels);

        const departmentData = {
            nacional: {
                almacenaje: {
                    name: "Nacional",
                    theme: { main: 'gray', text: 'text-gray-800', kpiBg: 'bg-gray-100', kpiBorder: 'border-l-gray-700', kpiPastBorder: 'border-l-gray-400', kpiProposedBg: 'bg-gray-200', kpiProposedBorder: 'border-l-gray-800', chartBg: 'rgba(107, 114, 128, 0.6)', chartBorder: 'rgba(55, 65, 81, 1)' },
                    kpis: { 
                        past: [
                            { year: 'G.22-23', value: '0.38', obj: '0.38', met: true }, 
                            { year: 'G.23-24', value: '0.38', obj: '0.38', met: true }
                        ], 
                        current: { year: 'G.24-25 (FAE + FC)', value: '0.48', obj: '0.53', met: true }, 
                        proposed: { year: 'G.2025-2026', title: 'OBJETIVO (FAE + FC)', value: '0.58' } 
                    },
                    costs: [
                        { account: 'Sueldos Y Jornales', value: 1088835, projected_value: 1316584 }, { account: 'Beneficios Sociales', value: 795012, projected_value: 962813 }, { account: 'Gastos De Alimentacion', value: 109072, projected_value: 134762 }, { account: 'Horas Extras', value: 153332, projected_value: 188647 }, { account: 'Ropa De Trabajo', value: 68260, projected_value: 104748 }, { account: 'Gastos Medicos Y Capacitacion', value: 23534, projected_value: 26008 }, { account: 'Depreciacion', value: 967692, projected_value: 1434896 }, { account: 'Desgaste de Canastilla', value: 90783, projected_value: 93142 }, { account: 'Cconectividad y comunicaciones', value: 26940, projected_value: 28751 }, { account: 'Gastos legales y tributarios', value: 32929, projected_value: 38476 }, { account: 'Sistemas tecnologicos', value: 4734, projected_value: 8277 }, { account: 'Servicios Externos', value: 200385, projected_value: 305681 }, { account: 'Gastos Generales', value: 114261, projected_value: 169437 }, { account: 'Seguros Gral, Fletes De Producto', value: 1386, projected_value: 1540 }, { account: 'Pasajes Y Viaticos', value: 13277, projected_value: 13277 }, { account: 'Material Y Prod.Limpieza', value: 35819, projected_value: 50203 }, { account: 'Energia Electrica Y Agua', value: 429265, projected_value: 580764 }, { account: 'Mantenimiento Y Repuestos', value: 103700, projected_value: 171619 }, { account: 'Materiales Escritorio Y Suministros', value: 42550, projected_value: 59027 }, { account: 'Envases', value: 137016, projected_value: 185263 }, { account: 'Consumo De Hielo', value: 248, projected_value: 276 }, { account: 'Productos Quimicos', value: 3340, projected_value: 4376 }, { account: 'baja de productos', value: 14447, projected_value: 11774 }, { account: 'Costo de Servicios Internos', value: 370917, projected_value: 434307 }, { account: 'Costo de servicio de areas de soporte', value: 152345, projected_value: 184795 }, { account: 'Mantenimiento Interno', value: 291083, projected_value: 388817 }, { account: 'Costos Lav. Y Ctrol de Canastillas', value: 159155, projected_value: 191397 }, { account: 'Costo Almacenaje Mat. Y Sum.', value: 1189, projected_value: 2314 }
                    ],
                    premises: [ '<strong>Depreciación:</strong> Apertura del CD-ESMERALDA y la ampliación del almacén de secos en SC.', '<strong>Sueldos y Jornales, Beneficios Sociales, Costo de Servicios Internos:</strong> Incremento del 12% promedio por el Decreto Supremo N° 5383 (5% al haber básico y 10% al salario mínimo nacional).', '<strong>Energía Eléctrica y Agua:</strong> Incremento por la apertura de NCD-ESMERALDA.', '<strong>Servicios Externos:</strong> Se estimó un 10% por la inflación. En esta cuenta lo que más impacta son los jornaleros y además del servicio de limpieza de cámaras/antecámaras y racks.' ],
                    trendData: {
                        labels: ['G-2022-2023', 'G-2023-2024', 'G-2024-2025'],
                        costs: [4747920, 5429215, 7277060],
                        sales: [12350054, 13928553, 14761753]
                    }
                },
                transporte: {
                    name: "Nacional Transporte",
                    theme: { main: 'gray', text: 'text-gray-800', kpiBg: 'bg-gray-100', kpiBorder: 'border-l-gray-700', kpiPastBorder: 'border-l-gray-400', kpiProposedBg: 'bg-gray-200', kpiProposedBorder: 'border-l-gray-800', chartBg: 'rgba(107, 114, 128, 0.6)', chartBorder: 'rgba(55, 65, 81, 1)' },
                    kpis: { 
                        past: [
                            { year: 'G.22-23', value: '0.41', obj: '0.40', met: false }, 
                            { year: 'G.23-24', value: '0.41', obj: '0.39', met: false }
                        ], 
                        current: { year: 'G.24-25', value: '0.43', obj: '0.39', met: false }, 
                        proposed: { year: 'G.2025-2026', value: '0.49' } 
                    },
                    costs: [ 
                        { account: 'Sueldos Y Jornales', value: 919992, projected_value: 1033365 }, { account: 'Beneficios Sociales', value: 728253, projected_value: 817969 }, { account: 'Gastos De Alimentacion', value: 101735, projected_value: 117503 }, { account: 'Horas Extras', value: 236457, projected_value: 264832 }, { account: 'Ropa De Trabajo', value: 72673, projected_value: 101514 }, { account: 'Gastos Medicos Y Capacitacion', value: 17999, projected_value: 18899 }, { account: 'Depreciacion', value: 100819, projected_value: 104575 }, { account: 'Desgaste de Canastilla', value: 61815, projected_value: 61815 }, { account: 'Cconectividad y comunicaciones', value: 15662, projected_value: 16374 }, { account: 'Gastos legales y tributarios', value: 29840, projected_value: 29840 }, { account: 'Sistemas tecnologicos', value: 53930, projected_value: 58685 }, { account: 'Servicios Externos', value: 183382, projected_value: 253520 }, { account: 'Gastos Generales', value: 50319, projected_value: 56296 }, { account: 'Seguros Gral, Fletes De Producto', value: 2037610, projected_value: 2445132 }, { account: 'Pasajes Y Viaticos', value: 5395, projected_value: 6224 }, { account: 'Material Y Prod.Limpieza', value: 8049, projected_value: 10491 }, { account: 'Energia Electrica Y Agua', value: 19404, projected_value: 23240 }, { account: 'Mantenimiento Y Repuestos', value: 14419, projected_value: 7277 }, { account: 'Materiales Escritorio Y Suministros', value: 27725, projected_value: 36131 }, { account: 'Envases', value: 37559, projected_value: 45570 }, { account: 'Productos Quimicos', value: 49, projected_value: 53 }, { account: 'baja de productos', value: 1173, projected_value: 1173 }, { account: 'Costo de Servicios Internos', value: 434213, projected_value: 488141 }, { account: 'Costo de servicio de areas de soporte', value: 47463, projected_value: 53865 }, { account: 'Mantenimiento Interno', value: 1010, projected_value: 1131 }, { account: 'Costos Lav. Y Ctrol de Canastillas', value: 101520, projected_value: 113702 }, { account: 'Costo Almacenaje Mat. Y Sum.', value: 23835, projected_value: 29184 }
                    ],
                    premises: [ '<strong>Flete:</strong> El incremento proyectado es de hasta 20%, sin garantizar que se llegue al techo máximo.', '<strong>Sueldos y Jornales, Beneficios Sociales, Costo de Servicios Internos:</strong> Incremento del 12% promedio por el Decreto Supremo N° 5383.', '<strong>Servicios Externos:</strong> Se estimó un 10% por la inflación a nivel nacional. Contratación de personal eventual (Lebrant) e incremento por pago de seguro de transporte de personal 15% (LA PAZ).' ],
                    trendData: {
                        labels: ['G-2022-2023', 'G-2023-2024', 'G-2024-2025'],
                        costs: [4913817, 5466938, 5948289],
                        sales: [12000750, 13217073, 13761362]
                    }
                }
            },
            cbba: {
                almacenaje: {
                    name: "Cochabamba Almacenaje",
                    theme: { main: 'blue', text: 'text-blue-800', kpiBg: 'bg-blue-100', kpiBorder: 'border-l-blue-700', kpiPastBorder: 'border-l-blue-400', kpiProposedBg: 'bg-blue-200', kpiProposedBorder: 'border-l-blue-800', chartBg: 'rgba(59, 130, 246, 0.6)', chartBorder: 'rgba(37, 99, 235, 1)' },
                    kpis: { past: [{ year: 'G.22-23', value: '0.45', obj: '0.46', met: true }, { year: 'G.23-24', value: '0.44', obj: '0.45', met: false }], current: { year: '(G.24-25)', value: '0.43', obj: '0.43', met: true }, proposed: { year: 'G.2025-2026', value: '0.71' } },
                    costs: [
                        { category: 'MANO DE OBRA', account: 'Sueldos Y Jornales', value: 191071, projected_value: 217821 }, { category: 'MANO DE OBRA', account: 'Beneficios Sociales', value: 144213, projected_value: 164403 }, { category: 'MANO DE OBRA', account: 'Gastos De Alimentacion', value: 17279, projected_value: 19871 }, { category: 'MANO DE OBRA', account: 'Horas Extras', value: 18920, projected_value: 21190 }, { category: 'MANO DE OBRA', account: 'Ropa De Trabajo', value: 12804, projected_value: 17925 }, { category: 'MANO DE OBRA', account: 'Gastos Medicos Y Capacitacion', value: 6395, projected_value: 6715 }, { category: 'Costos Fijos', account: 'Depreciacion', value: 63061, projected_value: 416511 }, { category: 'Costos Fijos', account: 'Desgaste de Canastilla', value: 16385, projected_value: 16385 }, { category: 'Costos Fijos', account: 'Cconectividad y comunicaciones', value: 2253, projected_value: 5315 }, { category: 'Costos Fijos', account: 'Gastos legales y tributarios', value: 3557, projected_value: 7113 }, { category: 'Costos Fijos', account: 'Sistemas tecnologicos', value: 2160, projected_value: 2160 }, { category: 'Costos Fijos', account: 'Servicios Externos', value: 8368, projected_value: 9204 }, { category: 'Costos Fijos', account: 'Gastos Generales', value: 22360, projected_value: 41105 }, { category: 'Costos Fijos', account: 'Seguros Gral, Fletes De Producto', value: 638, projected_value: 638 }, { category: 'Costos Fijos', account: 'Pasajes Y Viaticos', value: 3130, projected_value: 3130 }, { category: 'Costos variables', account: 'Material Y Prod.Limpieza', value: 8877, projected_value: 11540 }, { category: 'Costos variables', account: 'Energia Electrica Y Agua', value: 40938, projected_value: 109741 }, { category: 'Costos variables', account: 'Mantenimiento Y Repuestos', value: 22321, projected_value: 35714 }, { category: 'Costos variables', account: 'Materiales Escritorio Y Suministros', value: 11519, projected_value: 14975 }, { category: 'Costos variables', account: 'Baja De Productos', value: 7105, projected_value: 7105 }, { category: 'Costos variables', account: 'Envases', value: 9868, projected_value: 11842 }, { category: 'Costos variables', account: 'Consumo De Hielo', value: 276, projected_value: 276 }, { category: 'Costos variables', account: 'Costo de Servicios Internos', value: 58998, projected_value: 66078 }, { category: 'Costos variables', account: 'Costo de servicio de areas de soporte', value: 38427, projected_value: 46113 }, { category: 'Costos variables', account: 'Mantenimiento Interno', value: 8632, projected_value: 48632 }, { category: 'Costos variables', account: 'Costos Lav. Y Ctrol de Canastillas', value: 32521, projected_value: 37073 }, { category: 'Costos variables', account: 'Costo Almacenaje Mat. Y Sum.', value: 17809, projected_value: 19946 },
                    ],
                    premises: [ '<strong>Depreciación del CD-ESMERALDA:</strong> 353,450.', '<strong>Energía Eléctrica y Agua:</strong> Incremento por el Nuevo CD-ESMERALDA.', '<strong>Mantenimiento Interno:</strong> Incorporación de 5 nuevos técnicos.', '<strong>Sueldos y Jornales:</strong> Incremento del 12% promedio por el Decreto Supremo N° 5383 (5% al haber básico y 10% al salario mínimo nacional). Además de la contratación de 4 ayudantes de almacén por productividad.', '<strong>Gastos Generales:</strong> El traslado al NCD implica un incremento por: <ul class="list-disc list-inside ml-4"><li>La contratación de tres guardias adicionales (dos para el turno de día y uno para el de noche). De este monto, el 60% asume DP.</li><li>Servicios de control de plagas y fumigación (5,730).</li></ul>' ],
                    trendData: {
                        labels: ['G-2022-2023', 'G-2023-2024', 'G-2024-2025'],
                        costs: [645329, 766539, 780543],
                        sales: [1439668, 1755615, 1797431]
                    }
                },
                transporte: {
                    name: "Cochabamba Transporte",
                    theme: { main: 'blue', text: 'text-blue-800', kpiBg: 'bg-blue-100', kpiBorder: 'border-l-blue-700', kpiPastBorder: 'border-l-blue-400', kpiProposedBg: 'bg-blue-200', kpiProposedBorder: 'border-l-blue-800', chartBg: 'rgba(59, 130, 246, 0.6)', chartBorder: 'rgba(37, 99, 235, 1)' },
                    kpis: { past: [{ year: 'G.22-23', value: '0.47', obj: '0.50', met: true }, { year: 'G.23-24', value: '0.48', obj: '0.47', met: false }], current: { year: '(G.24-25)', value: '0.48', obj: '0.46', met: false }, proposed: { year: 'G.2025-2026', value: '0.51' } },
                    costs: [
                        { category: 'MANO DE OBRA', account: 'Sueldos Y Jornales', value: 153157, projected_value: 171536 }, { category: 'MANO DE OBRA', account: 'Beneficios Sociales', value: 117146, projected_value: 131204 }, { category: 'MANO DE OBRA', account: 'Gastos De Alimentacion', value: 11431, projected_value: 13718 }, { category: 'MANO DE OBRA', account: 'Horas Extras', value: 17065, projected_value: 19113 }, { category: 'MANO DE OBRA', account: 'Ropa De Trabajo', value: 7112, projected_value: 9956 }, { category: 'MANO DE OBRA', account: 'Gastos Medicos Y Capacitacion', value: 4129, projected_value: 4536 }, { category: 'Costos Fijos', account: 'Depreciacion', value: 15765, projected_value: 19939 }, { category: 'Costos Fijos', account: 'Desgaste de Canastilla', value: 8904, projected_value: 8904 }, { category: 'Costos Fijos', account: 'Cconectividad y comunicaciones', value: 2254, projected_value: 4654 }, { category: 'Costos Fijos', account: 'Gastos legales y tributarios', value: 600, projected_value: 600 }, { category: 'Costos Fijos', account: 'Sistemas tecnologicos', value: 11560, projected_value: 12670 }, { category: 'Costos Fijos', account: 'Servicios Externos', value: 4399, projected_value: 4839 }, { category: 'Costos Fijos', account: 'Gastos Generales', value: 7085, projected_value: 11285 }, { category: 'Costos Fijos', account: 'Seguros Gral, Fletes De Producto', value: 292087, projected_value: 350504 }, { category: 'Costos Fijos', account: 'Pasajes Y Viaticos', value: 15376, projected_value: 19220 }, { category: 'costos variables', account: 'Material Y Prod.Limpieza', value: 1883, projected_value: 2448 }, { category: 'costos variables', account: 'Energia Electrica Y Agua', value: 4736, projected_value: 8998 }, { category: 'costos variables', account: 'Mantenimiento Y Repuestos', value: 367, projected_value: 478 }, { category: 'costos variables', account: 'Materiales Escritorio Y Suministros', value: 8411, projected_value: 10935 }, { category: 'costos variables', account: 'Baja De Productos', value: 397, projected_value: 397 }, { category: 'costos variables', account: 'Costo de Servicios Internos', value: 68685, projected_value: 76927 }, { category: 'costos variables', account: 'Costo de servicio de areas de soporte', value: 9815, projected_value: 11778 }, { category: 'costos variables', account: 'Mantenimiento Interno', value: 22, projected_value: 25 }, { category: 'costos variables', account: 'Costos Lav. Y Ctrol de Canastillas', value: 11810, projected_value: 13228 }, { category: 'costos variables', account: 'Costo Almacenaje Mat. Y Sum.', value: 8848, projected_value: 9910 }
                    ],
                    premises: [ '<strong>Flete:</strong> El incremento proyectado es de hasta 20%, sin garantizar que se llegue al techo máximo.', '<strong>Sueldos y Jornales, Beneficios Sociales y Costo de Servicios Internos:</strong> Incremento del 12% promedio por el Decreto Supremo N° 5383.', '<strong>Energía Eléctrica y Agua:</strong> Incremento por la apertura de NCD-ESMERALDA.', '<strong>Gastos Generales:</strong> Por el cambio al CD-ESMERALDA, la cuenta tendrá un incremento debido a la necesidad de aumentar el personal para reforzar la seguridad. De este incremento, Transporte asumirá un 35%.' ],
                    trendData: {
                        labels: ['G-2022-2023', 'G-2023-2024', 'G-2024-2025'],
                        costs: [673989, 748787, 784905],
                        sales: [1440595, 1552590, 1649149]
                    }
                }
            },
            scz: {
                almacenaje: {
                    name: "Santa Cruz Almacenaje",
                    theme: { main: 'green', text: 'text-green-800', kpiBg: 'bg-green-100', kpiBorder: 'border-l-green-700', kpiPastBorder: 'border-l-green-400', kpiProposedBg: 'bg-green-200', kpiProposedBorder: 'border-l-green-800', chartBg: 'rgba(22, 163, 74, 0.6)', chartBorder: 'rgba(21, 128, 61, 1)' },
                    kpis: { past: [{ year: 'G.22-23', value: '0.47', obj: '0.50', met: true }, { year: 'G.23-24', value: '0.45', obj: '0.48', met: true }], current: { year: '(G.24-25)', value: '0.39', obj: '0.47', met: true }, proposed: { year: 'G.2025-2026', value: '0.45' } },
                    costs: [
                        { category: 'MANO DE OBRA', account: 'Sueldos Y Jornales', value: 529123, projected_value: 592617 }, { category: 'MANO DE OBRA', account: 'Beneficios Sociales', value: 391231, projected_value: 438179 }, { category: 'MANO DE OBRA', account: 'Gastos De Alimentacion', value: 50062, projected_value: 57572 }, { category: 'MANO DE OBRA', account: 'Horas Extras', value: 87166, projected_value: 97626 }, { category: 'MANO DE OBRA', account: 'Ropa De Trabajo', value: 35595, projected_value: 47847 }, { category: 'MANO DE OBRA', account: 'Gastos Medicos Y Capacitacion', value: 8831, projected_value: 9138 }, { category: 'Costos Fijos', account: 'Depreciacion', value: 665180, projected_value: 704180 }, { category: 'Costos Fijos', account: 'Desgaste de Canastilla', value: 47812, projected_value: 47812 }, { category: 'Costos Fijos', account: 'Cconectividad y comunicaciones', value: 2958, projected_value: 3106 }, { category: 'Costos Fijos', account: 'Gastos legales y tributarios', value: 14484, projected_value: 14484 }, { category: 'Costos Fijos', account: 'Sistemas tecnologicos', value: 1528, projected_value: 1528 }, { category: 'Costos Fijos', account: 'Servicios Externos', value: 71571, projected_value: 137303 }, { category: 'Costos Fijos', account: 'Gastos Generales', value: 35756, projected_value: 41120 }, { category: 'Costos Fijos', account: 'Seguros Gral, Fletes De Producto', value: 902, projected_value: 902 }, { category: 'Costos Fijos', account: 'Pasajes Y Viaticos', value: 473, projected_value: 473 }, { category: 'Costos variables', account: 'Material Y Prod.Limpieza', value: 14769, projected_value: 19200 }, { category: 'Costos variables', account: 'Energia Electrica Y Agua', value: 280000, projected_value: 280000 }, { category: 'Costos variables', account: 'Mantenimiento Y Repuestos', value: 44251, projected_value: 57526 }, { category: 'Costos variables', account: 'Materiales Escritorio Y Suministros', value: 20512, projected_value: 26666 }, { category: 'Costos variables', account: 'Envases', value: 71002, projected_value: 85202 }, { category: 'Costos variables', account: 'Baja De Productos', value: 2956, projected_value: 2956 }, { category: 'Costos variables', account: 'Productos Quimicos', value: 3646, projected_value: 3646 }, { category: 'Costos variables', account: 'Costo de Servicios Internos', value: 161827, projected_value: 181246 }, { category: 'Costos variables', account: 'Costo de servicio de areas de soporte', value: 60623, projected_value: 67898 }, { category: 'Costos variables', account: 'Mantenimiento Interno', value: 192644, projected_value: 215762 }, { category: 'Costos variables', account: 'Costos Lav. Y Ctrol de Canastillas', value: 79022, projected_value: 88505 }, { category: 'Costos variables', account: 'Costo Almacenaje Mat. Y Sum.', value: 36659, projected_value: 36659 },
                    ],
                    premises: [ '<strong>Servicios Externos:</strong> Se estimó un 10% por inflación; además, se incorporan dos servicios adicionales: lavado de rack del nuevo almacén de secos y lavado de antecámara.', '<strong>Sueldos y Jornales, Beneficios Sociales:</strong> Incremento del 12% promedio por el Decreto Supremo N° 5383.', '<strong>Depreciación:</strong> Incremento por la ampliación del almacén de secos (39,000 Bs aprox).' ],
                    trendData: {
                        labels: ['G-2022-2023', 'G-2023-2024', 'G-2024-2025'],
                        costs: [2317812, 2580231, 2793512],
                        sales: [5129651, 5671870, 6808238]
                    }
                },
                transporte: {
                    name: "Santa Cruz Transporte",
                    theme: { main: 'green', text: 'text-green-800', kpiBg: 'bg-green-100', kpiBorder: 'border-l-green-700', kpiPastBorder: 'border-l-green-400', kpiProposedBg: 'bg-green-200', kpiProposedBorder: 'border-l-green-800', chartBg: 'rgba(22, 163, 74, 0.6)', chartBorder: 'rgba(21, 128, 61, 1)' },
                    kpis: { past: [{ year: 'G.22-23', value: '0.47', obj: '0.50', met: true }, { year: 'G.23-24', value: '0.45', obj: '0.48', met: true }], current: { year: '(G.24-25)', value: '0.40', obj: '0.45', met: true }, proposed: { year: 'G.2025-2026', value: '0.44' } },
                    costs: [
                        { category: 'MANO DE OBRA', account: 'Sueldos Y Jornales', value: 397003, projected_value: 444644 }, { category: 'MANO DE OBRA', account: 'Beneficios Sociales', value: 322804, projected_value: 361541 }, { category: 'MANO DE OBRA', account: 'Gastos De Alimentacion', value: 46292, projected_value: 53236 }, { category: 'MANO DE OBRA', account: 'Horas Extras', value: 152269, projected_value: 170541 }, { category: 'MANO DE OBRA', account: 'Ropa De Trabajo', value: 50200, projected_value: 70280 }, { category: 'MANO DE OBRA', account: 'Gastos Medicos Y Capacitacion', value: 6330, projected_value: 6646 }, { category: 'Costos Fijos', account: 'Depreciacion', value: 47244, projected_value: 47244 }, { category: 'Costos Fijos', account: 'Desgaste de Canastilla', value: 31834, projected_value: 31834 }, { category: 'Costos Fijos', account: 'Cconectividad y comunicaciones', value: 3261, projected_value: 3424 }, { category: 'Costos Fijos', account: 'Gastos legales y tributarios', value: 14250, projected_value: 14250 }, { category: 'Costos Fijos', account: 'Sistemas tecnologicos', value: 19401, projected_value: 22937 }, { category: 'Costos Fijos', account: 'Servicios Externos', value: 131981, projected_value: 145179 }, { category: 'Costos Fijos', account: 'Gastos Generales', value: 16305, projected_value: 17120 }, { category: 'Costos Fijos', account: 'Seguros Gral, Fletes De Producto', value: 1064322, projected_value: 1277186 }, { category: 'Costos Fijos', account: 'Pasajes Y Viaticos', value: 7, projected_value: 7 }, { category: 'costos variables', account: 'Material Y Prod.Limpieza', value: 4045, projected_value: 5258 }, { category: 'costos variables', account: 'Energia Electrica Y Agua', value: 9810, projected_value: 9810 }, { category: 'costos variables', account: 'Mantenimiento Y Repuestos', value: 871, projected_value: 1132 }, { category: 'costos variables', account: 'Materiales Escritorio Y Suministros', value: 6642, projected_value: 8635 }, { category: 'costos variables', account: 'Baja De Productos', value: 488, projected_value: 488 }, { category: 'costos variables', account: 'Envases', value: 516, projected_value: 516 }, { category: 'costos variables', account: 'Productos Quimicos', value: 54, projected_value: 58 }, { category: 'costos variables', account: 'Costo de Servicios Internos', value: 183561, projected_value: 205588 }, { category: 'costos variables', account: 'Costo de servicio de areas de soporte', value: 21229, projected_value: 23776 }, { category: 'costos variables', account: 'Mantenimiento Interno', value: 1100, projected_value: 1232 }, { category: 'costos variables', account: 'Costos Lav. Y Ctrol de Canastillas', value: 35693, projected_value: 39976 }, { category: 'costos variables', account: 'Costo Almacenaje Mat. Y Sum.', value: 10862, projected_value: 12165 }
                    ],
                    premises: [ '<strong>Flete:</strong> El incremento proyectado es de hasta 20%, sin garantizar que se llegue al techo máximo.', '<strong>Sueldos y Jornales, Beneficios Sociales, Costo de Servicios Internos:</strong> Incremento del 12% promedio por el Decreto Supremo N° 5383.', '<strong>Ropa de Trabajo:</strong> Se estimó un incremento del 40% debido al impacto de la inflación.' ],
                    trendData: {
                        labels: ['G-2022-2023', 'G-2023-2024', 'G-2024-2025'],
                        costs: [2242026, 2456638, 2306370],
                        sales: [4750703, 5441661, 6377923]
                    }
                }
            },
            sucre: {
                almacenaje: {
                    name: "Sucre Almacenaje",
                    theme: { main: 'red', text: 'text-red-800', kpiBg: 'bg-red-100', kpiBorder: 'border-l-red-700', kpiPastBorder: 'border-l-red-400', kpiProposedBg: 'bg-red-200', kpiProposedBorder: 'border-l-red-800', chartBg: 'rgba(220, 38, 38, 0.6)', chartBorder: 'rgba(185, 28, 28, 1)' },
                    kpis: { past: [{ year: 'G.22-23', value: '0.45', obj: '0.47', met: true }, { year: 'G.23-24', value: '0.38', obj: '0.47', met: true }], current: { year: '(G.24-25)', value: '0.73', obj: '0.46', met: false }, proposed: { year: 'G.2025-2026', value: '0.98' } },
                    costs: [
                        { category: 'MANO DE OBRA', account: 'Sueldos Y Jornales', value: 16325, projected_value: 18284 }, { category: 'MANO DE OBRA', account: 'Beneficios Sociales', value: 13527, projected_value: 15150 }, { category: 'MANO DE OBRA', account: 'Gastos De Alimentacion', value: 2405, projected_value: 2765 }, { category: 'MANO DE OBRA', account: 'Horas Extras', value: 2026, projected_value: 2269 }, { category: 'MANO DE OBRA', account: 'Ropa De Trabajo', value: 4128, projected_value: 5779 }, { category: 'MANO DE OBRA', account: 'Gastos Medicos Y Capacitacion', value: 415, projected_value: 436 }, { category: 'Costos Fijos', account: 'Depreciacion', value: 11028, projected_value: 15547 }, { category: 'Costos Fijos', account: 'Desgaste de Canastilla', value: 2118, projected_value: 2118 }, { category: 'Costos Fijos', account: 'Cconectividad y comunicaciones', value: 5898, projected_value: 6193 }, { category: 'Costos Fijos', account: 'Gastos legales y tributarios', value: 200, projected_value: 200 }, { category: 'Costos Fijos', account: 'Sistemas tecnologicos', value: 1137, projected_value: 488 }, { category: 'Costos Fijos', account: 'Servicios Externos', value: 5202, projected_value: 5722 }, { category: 'Costos Fijos', account: 'Gastos Generales', value: 26643, projected_value: 27975 }, { category: 'Costos Fijos', account: 'Pasajes Y Viaticos', value: 2188, projected_value: 2188 }, { category: 'Costos variables', account: 'Material Y Prod.Limpieza', value: 1291, projected_value: 1679 }, { category: 'Costos variables', account: 'Energia Electrica Y Agua', value: 30861, projected_value: 41654 }, { category: 'Costos variables', account: 'Mantenimiento Y Repuestos', value: 4327, projected_value: 5625 }, { category: 'Costos variables', account: 'Materiales Escritorio Y Suministros', value: 1267, projected_value: 1647 }, { category: 'Costos variables', account: 'Envases', value: 1664, projected_value: 1997 }, { category: 'Costos variables', account: 'Baja De Productos', value: 29, projected_value: 29 }, { category: 'Costos variables', account: 'Costo de Servicios Internos', value: 29880, projected_value: 33466 }, { category: 'Costos variables', account: 'Mantenimiento Interno', value: 2328, projected_value: 2607 }, { category: 'Costos variables', account: 'Costo Almacenaje Mat. Y Sum.', value: 5060, projected_value: 5667 },
                    ],
                    premises: [ '<strong>Energía Eléctrica y Agua:</strong> Con el funcionamiento de 12 contenedores (3 nuevos), proyectamos un aumento del 33,33% en consumo eléctrico, considerando un consumo promedio de Bs 3,598 por contenedor y tarifa de Bs 2,10 por kWh.', '<strong>Depreciación:</strong> La transferencia de activos de 3 contenedores de la ciudad de CBBA, incrementará la depreciación mensual en 1,506 Bs por contenedor.', '<strong>Sueldos y Jornales, Costo de Servicios Internos:</strong> Incremento del 12% promedio por el Decreto Supremo N° 5383.' ],
                    trendData: {
                        labels: ['G-2022-2023', 'G-2023-2024', 'G-2024-2025'],
                        costs: [115496, 139595, 177837],
                        sales: [251711, 370959, 244773]
                    }
                },
                transporte: {
                    name: "Sucre Transporte",
                    theme: { main: 'red', text: 'text-red-800', kpiBg: 'bg-red-100', kpiBorder: 'border-l-red-700', kpiPastBorder: 'border-l-red-400', kpiProposedBg: 'bg-red-200', kpiProposedBorder: 'border-l-red-800', chartBg: 'rgba(220, 38, 38, 0.6)', chartBorder: 'rgba(185, 28, 28, 1)' },
                    kpis: { past: [{ year: 'G.22-23', value: '0.15', obj: '0.17', met: true }, { year: 'G.23-24', value: '0.21', obj: '0.17', met: false }], current: { year: '(G.24-25)', value: '0.30', obj: '0.21', met: false }, proposed: { year: 'G.2025-2026', value: '0.35' } },
                    costs: [
                        { account: 'Depreciacion', value: 135, projected_value: 135 }, { account: 'Desgaste de Canastilla', value: 1796, projected_value: 1796 }, { account: 'Sistemas tecnologicos', value: 763, projected_value: 763 }, { account: 'Servicios Externos', value: 403, projected_value: 443 }, { account: 'Gastos Generales', value: 1615, projected_value: 1696 }, { account: 'Seguros Gral, Fletes De Producto', value: 27368, projected_value: 32841 }, { account: 'Costo de Servicios Internos', value: 13540, projected_value: 15165 }, { account: 'Costo Almacenaje Mat. Y Sum.', value: 1217, projected_value: 1363 }
                    ],
                    premises: [ '<strong>Flete:</strong> El incremento proyectado es de hasta 20%, sin garantizar que se llegue al techo máximo.', '<strong>Costo de Servicios Internos:</strong> Incremento del 12% promedio por el Decreto Supremo N° 5383.' ],
                    trendData: {
                        labels: ['G-2022-2023', 'G-2023-2024', 'G-2024-2025'],
                        costs: [37023, 42006, 46742],
                        sales: [251711, 196865, 153914]
                    }
                }
            },
            trinidad: {
                almacenaje: {
                    name: "Trinidad Almacenaje",
                    theme: { main: 'emerald', text: 'text-emerald-800', kpiBg: 'bg-emerald-100', kpiBorder: 'border-l-emerald-700', kpiPastBorder: 'border-l-emerald-400', kpiProposedBg: 'bg-emerald-200', kpiProposedBorder: 'border-l-emerald-800', chartBg: 'rgba(16, 185, 129, 0.6)', chartBorder: 'rgba(6, 95, 70, 1)' },
                    kpis: { past: [{ year: 'G.22-23', value: '1.30', obj: '1.26', met: false }, { year: 'G.23-24', value: '1.20', obj: '1.26', met: true }], current: { year: '(G.24-25)', value: '1.12', obj: '1.27', met: true }, proposed: { year: 'G.2025-2026', value: '1.04' } },
                    costs: [
                        { category: 'MANO DE OBRA', account: 'Sueldos Y Jornales', value: 15841, projected_value: 17742 }, { category: 'MANO DE OBRA', account: 'Beneficios Sociales', value: 11815, projected_value: 13233 }, { category: 'MANO DE OBRA', account: 'Gastos De Alimentacion', value: 397, projected_value: 457 }, { category: 'MANO DE OBRA', account: 'Horas Extras', value: 1604, projected_value: 1796 }, { category: 'MANO DE OBRA', account: 'Ropa De Trabajo', value: 1611, projected_value: 2255 }, { category: 'Costos Fijos', account: 'Depreciacion', value: 16054, projected_value: 16054 }, { category: 'Costos Fijos', account: 'Desgaste de Canastilla', value: 3430, projected_value: 3430 }, { category: 'Costos Fijos', account: 'Cconectividad y comunicaciones', value: 9348, projected_value: 9815 }, { category: 'Costos Fijos', account: 'Gastos legales y tributarios', value: 178, projected_value: 178 }, { category: 'Costos Fijos', account: 'Sistemas tecnologicos', value: 1137, projected_value: 488 }, { category: 'Costos Fijos', account: 'Servicios Externos', value: 1922, projected_value: 2114 }, { category: 'Costos Fijos', account: 'Gastos Generales', value: 3941, projected_value: 4138 }, { category: 'Costos Fijos', account: 'Pasajes Y Viaticos', value: 1690, projected_value: 1690 }, { category: 'Costos variables', account: 'Material Y Prod.Limpieza', value: 1812, projected_value: 2355 }, { category: 'Costos variables', account: 'Energia Electrica Y Agua', value: 36836, projected_value: 36836 }, { category: 'Costos variables', account: 'Mantenimiento Y Repuestos', value: 3883, projected_value: 5048 }, { category: 'Costos variables', account: 'Materiales Escritorio Y Suministros', value: 2523, projected_value: 3280 }, { category: 'Costos variables', account: 'Envases', value: 2381, projected_value: 2858 }, { category: 'Costos variables', account: 'Baja De Productos', value: 152, projected_value: 152 }, { category: 'Costos variables', account: 'Costo de Servicios Internos', value: 25051, projected_value: 28058 }, { category: 'Costos variables', account: 'Mantenimiento Interno', value: 1730, projected_value: 1938 }, { category: 'Costos variables', account: 'Costo Almacenaje Mat. Y Sum.', value: 7056, projected_value: 7902 },
                    ],
                    premises: [ '<strong>Sueldos y Jornales, Beneficios Sociales, Costo de Servicios Internos:</strong> Incremento del 12% promedio por el Decreto Supremo N° 5383.', '<strong>Mantenimiento y Repuestos:</strong> Se estimó un incremento del 30% debido al impacto de la inflación.' ],
                    trendData: {
                        labels: ['G-2022-2023', 'G-2023-2024', 'G-2024-2025'],
                        costs: [119588, 132261, 154363],
                        sales: [91944, 110675, 146743]
                    }
                },
                transporte: {
                    name: "Trinidad Transporte",
                    theme: { main: 'emerald', text: 'text-emerald-800', kpiBg: 'bg-emerald-100', kpiBorder: 'border-l-emerald-700', kpiPastBorder: 'border-l-emerald-400', kpiProposedBg: 'bg-emerald-200', kpiProposedBorder: 'border-l-emerald-800', chartBg: 'rgba(16, 185, 129, 0.6)', chartBorder: 'rgba(6, 95, 70, 1)' },
                    kpis: { past: [{ year: 'G.22-23', value: '0.51', obj: '0.56', met: true }, { year: 'G.23-24', value: '0.48', obj: '0.56', met: true }], current: { year: '(G.24-25)', value: '0.43', obj: '0.49', met: true }, proposed: { year: 'G.2025-2026', value: '0.44' } },
                    costs: [
                        { account: 'Sueldos Y Jornales', value: 168, projected_value: 168 }, { account: 'Ropa De Trabajo', value: 541, projected_value: 541 }, { account: 'Depreciacion', value: 12, projected_value: 12 }, { account: 'Desgaste de Canastilla', value: 2618, projected_value: 2618 }, { account: 'Sistemas tecnologicos', value: 223, projected_value: 223 }, { account: 'Servicios Externos', value: 528, projected_value: 581 }, { account: 'Gastos Generales', value: 2311, projected_value: 2426 }, { account: 'Seguros Gral, Fletes De Producto', value: 23718, projected_value: 28462 }, { account: 'Material Y Prod.Limpieza', value: 25, projected_value: 33 }, { account: 'Mantenimiento Y Repuestos', value: 8239, projected_value: 8239 }, { account: 'Materiales Escritorio Y Suministros', value: 97, projected_value: 126 }, { account: 'Envases', value: 455, projected_value: 455 }, { account: 'Costo de Servicios Internos', value: 23933, projected_value: 26805 }, { account: 'Costo Almacenaje Mat. Y Sum.', value: 1227, projected_value: 1375 }
                    ],
                    premises: [ '<strong>Flete:</strong> El incremento proyectado es de hasta 20%, sin garantizar que se llegue al techo máximo.', '<strong>Costo de Servicios Internos:</strong> Incremento del 12% promedio por el Decreto Supremo N° 5383.' ],
                    trendData: {
                        labels: ['G-2022-2023', 'G-2023-2024', 'G-2024-2025'],
                        costs: [47209, 51340, 58836],
                        sales: [92031, 106854, 138084]
                    }
                }
            },
            lpz: {
                 almacenaje: {
                    name: "La Paz Almacenaje",
                    theme: { main: 'red', text: 'text-red-800', kpiBg: 'bg-red-100', kpiBorder: 'border-l-red-700', kpiPastBorder: 'border-l-red-400', kpiProposedBg: 'bg-red-200', kpiProposedBorder: 'border-l-red-800', chartBg: 'rgba(220, 38, 38, 0.6)', chartBorder: 'rgba(185, 28, 28, 1)' },
                    kpis: { past: [{ year: 'G.22-23', value: '0.28', obj: '0.27', met: false }, { year: 'G.23-24', value: '0.30', obj: '0.28', met: false }], current: { year: '(G.24-25)', value: '0.34', obj: '0.30', met: false }, proposed: { year: 'G.2025-2026', value: '0.37' } },
                    costs: [
                        { account: 'Sueldos Y Jornales', value: 412386, projected_value: 470120 }, { account: 'Beneficios Sociales', value: 291095, projected_value: 331848 }, { account: 'Gastos De Alimentacion', value: 47042, projected_value: 54098 }, { account: 'Horas Extras', value: 58719, projected_value: 65766 }, { account: 'Ropa De Trabajo', value: 20813, projected_value: 29139 }, { account: 'Gastos Medicos Y Capacitacion', value: 9821, projected_value: 10312 }, { account: 'Depreciacion', value: 282475, projected_value: 282475 }, { account: 'Desgaste de Canastilla', value: 23411, projected_value: 23411 }, { account: 'Cconectividad y comunicaciones', value: 3978, projected_value: 4177 }, { account: 'Gastos legales y tributarios', value: 16492, projected_value: 16492 }, { account: 'Sistemas tecnologicos', value: 3613, projected_value: 3613 }, { account: 'Servicios Externos', value: 137579, projected_value: 151336 }, { account: 'Gastos Generales', value: 52475, projected_value: 55099 }, { account: 'Pasajes Y Viaticos', value: 5796, projected_value: 5796 }, { account: 'Material Y Prod.Limpieza', value: 11745, projected_value: 15269 }, { account: 'Energia Electrica Y Agua', value: 112533, projected_value: 112533 }, { account: 'Mantenimiento Y Repuestos', value: 52082, projected_value: 67706 }, { account: 'Materiales Escritorio Y Suministros', value: 9583, projected_value: 9583 }, { account: 'Envases', value: 69470, projected_value: 83364 }, { account: 'Productos Quimicos', value: 58, projected_value: 58 }, { account: 'baja de productos', value: 1532, projected_value: 1532 }, { account: 'Costo de Servicios Internos', value: 112018, projected_value: 125460 }, { account: 'Costo de servicio de areas de soporte', value: 63199, projected_value: 70783 }, { account: 'Mantenimiento Interno', value: 107034, projected_value: 107034 }, { account: 'Costos Lav. Y Ctrol de Canastillas', value: 58767, projected_value: 65819 }, { account: 'Costo Almacenaje Mat. Y Sum.', value: 4872, projected_value: 4872 }
                    ],
                    premises: [ '<strong>Sueldos y Jornales, Beneficios Sociales, Costo de Servicios Internos:</strong> Incremento del 12% promedio por el Decreto Supremo N° 5383; además de la incorporación de 3 ayudantes de almacén.', '<strong>Mantenimiento y Repuestos:</strong> Se estimó un incremento del 30% debido al impacto de la inflación.', '<strong>Servicios Externos:</strong> Incremento del 10% por inflación. En esta cuenta lo que más impacta es los jornaleros y además del servicio de limpieza de cámaras/antecámaras y racks.' ],
                    trendData: {
                        labels: ['G-2022-2023', 'G-2023-2024', 'G-2024-2025'],
                        costs: [1549695, 1810589, 1913701],
                        sales: [5465710, 6019432, 5711990]
                    }
                },
                 transporte: {
                    name: "La Paz Transporte",
                    theme: { main: 'red', text: 'text-red-800', kpiBg: 'bg-red-100', kpiBorder: 'border-l-red-700', kpiPastBorder: 'border-l-red-400', kpiProposedBg: 'bg-red-200', kpiProposedBorder: 'border-l-red-800', chartBg: 'rgba(220, 38, 38, 0.6)', chartBorder: 'rgba(185, 28, 28, 1)' },
                    kpis: { past: [{ year: 'G.22-23', value: '0.35', obj: '0.30', met: false }, { year: 'G.23-24', value: '0.37', obj: '0.35', met: false }], current: { year: '(G.24-25)', value: '0.41', obj: '0.37', met: false }, proposed: { year: 'G.2025-2026', value: '0.47' } },
                    costs: [
                        { account: 'Sueldos Y Jornales', value: 424848, projected_value: 478803 }, { account: 'Beneficios Sociales', value: 332297, projected_value: 374499 }, { account: 'Gastos De Alimentacion', value: 49778, projected_value: 57245 }, { account: 'Horas Extras', value: 84056, projected_value: 94143 }, { account: 'Ropa De Trabajo', value: 20930, projected_value: 29302 }, { account: 'Gastos Medicos Y Capacitacion', value: 8414, projected_value: 8835 }, { account: 'Depreciacion', value: 43978, projected_value: 43978 }, { account: 'Desgaste de Canastilla', value: 21179, projected_value: 21179 }, { account: 'Cconectividad y comunicaciones', value: 8670, projected_value: 9104 }, { account: 'Gastos legales y tributarios', value: 16475, projected_value: 16475 }, { account: 'Sistemas tecnologicos', value: 22855, projected_value: 25753 }, { account: 'Servicios Externos', value: 83026, projected_value: 117582 }, { account: 'Gastos Generales', value: 25735, projected_value: 27022 }, { account: 'Seguros Gral, Fletes De Producto', value: 770865, projected_value: 925038 }, { account: 'Pasajes Y Viaticos', value: 3258, projected_value: 3258 }, { account: 'Material Y Prod.Limpieza', value: 2712, projected_value: 3526 }, { account: 'Energia Electrica Y Agua', value: 6314, projected_value: 6314 }, { account: 'Mantenimiento Y Repuestos', value: 4483, projected_value: 5828 }, { account: 'Materiales Escritorio Y Suministros', value: 14158, projected_value: 18406 }, { account: 'Envases', value: 37049, projected_value: 45570 }, { account: 'Baja De Productos', value: 377, projected_value: 377 }, { account: 'Costo de Servicios Internos', value: 173543, projected_value: 196104 }, { account: 'Costo de servicio de areas de soporte', value: 19524, projected_value: 21867 }, { account: 'Costos Lav. Y Ctrol de Canastillas', value: 58767, projected_value: 65819 }, { account: 'Costo Almacenaje Mat. Y Sum.', value: 3903, projected_value: 4372 }
                    ],
                    premises: [ '<strong>Flete:</strong> El incremento proyectado es de hasta 20%, sin garantizar que se llegue al techo máximo.', '<strong>Sueldos y Jornales, Beneficios Sociales, Costo de Servicios Internos:</strong> Incremento del 12% promedio por el Decreto Supremo N° 5383.', '<strong>Servicios Externos:</strong> Incremento del 20% por contratación de personal eventual (Lebrant) y aumento del 15% en el seguro de transporte de personal.' ],
                    trendData: {
                        labels: ['G-2022-2023', 'G-2023-2024', 'G-2024-2025'],
                        costs: [1913569, 2168167, 2244434],
                        sales: [5465710, 5919103, 5602544]
                    }
                }
            }
        };

        let modalChartInstance = null;
        let activeCharts = [];
        let activeDept = 'cbba';
        let activeArea = 'almacenaje';

        function renderContent(deptKey, areaKey) {
            activeDept = deptKey;
            activeArea = areaKey;

            const data = departmentData[deptKey][areaKey];
            if (!data) {
                document.getElementById('content-area').innerHTML = `<div class="text-center p-8"><h2 class="text-2xl font-bold">Datos no disponibles para esta selección.</h2></div>`;
                return;
            }

            const theme = data.theme;
            const contentArea = document.getElementById('content-area');
            
            contentArea.innerHTML = '';
            activeCharts.forEach(chart => chart.destroy());
            activeCharts = [];
            
            const metIcon = `<svg class="w-4 h-4 mr-1" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path></svg>`;
            const notMetIcon = `<svg class="w-4 h-4 mr-1" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"></path></svg>`;

            let pastKpisHtml = data.kpis.past.map(kpi => `
                <div class="kpi-card p-4 rounded-lg shadow-md text-center ${theme.kpiBg} ${theme.kpiPastBorder}">
                    <p class="text-gray-500 text-sm font-medium">${kpi.year}</p>
                    <p class="text-3xl font-bold text-gray-800 my-1">${kpi.value}</p>
                    <p class="text-xs font-semibold flex items-center justify-center ${kpi.met ? 'text-green-600' : 'text-red-600'}">
                        ${kpi.met ? metIcon : notMetIcon}
                        ${kpi.met ? 'Cumplido' : 'Incumplido'}
                    </p>
                    <p class="text-xs text-gray-500">Obj: ${kpi.obj}</p>
                </div>
            `).join('');
            
            const areaTabs = Object.keys(departmentData[deptKey]).map(area => `
                <button class="area-tab px-4 py-2 text-sm font-medium rounded-t-lg ${area === areaKey ? `${theme.text} border-b-2 ${theme.kpiBorder}` : 'text-gray-500'}" data-area="${area}">
                    ${area.charAt(0).toUpperCase() + area.slice(1)}
                </button>
            `).join('');

            let currentKpiHtml = `
                <div class="kpi-card p-4 rounded-lg shadow-md text-center ${theme.kpiBg} ${theme.kpiBorder}">
                    <p class="text-gray-600 text-sm font-medium">${data.kpis.current.year}</p>
                    <p class="text-3xl font-bold ${theme.text} my-1">${data.kpis.current.value}</p>
                    <p class="text-xs font-semibold flex items-center justify-center ${data.kpis.current.met ? 'text-green-600' : 'text-red-600'}">
                        ${data.kpis.current.met ? metIcon : notMetIcon}
                        ${data.kpis.current.met ? 'Cumplido' : 'Incumplido'}
                    </p>
                    <p class="text-xs text-gray-500">Obj: ${data.kpis.current.obj}</p>
                </div>`;

            let proposedKpiHtml = `
                <div class="kpi-card p-4 rounded-lg shadow-md text-center ${theme.kpiProposedBg} ${theme.kpiProposedBorder}">
                    <p class="text-gray-600 text-sm font-medium">${data.kpis.proposed.title || 'OBJETIVO PROPUESTO'}</p>
                    <p class="text-3xl font-bold ${theme.text} my-1">${data.kpis.proposed.value}</p>
                    <p class="text-xs text-gray-500">${data.kpis.proposed.year}</p>
                </div>`;
            
            if(deptKey === 'nacional'){
                currentKpiHtml = `
                <div class="kpi-card p-4 rounded-lg shadow-md text-center ${theme.kpiBg} ${theme.kpiBorder}">
                    <p class="text-gray-600 text-sm font-medium">${data.kpis.current.year}</p>
                    <div class="my-1">
                        <p class="text-3xl font-bold ${theme.text} kpi-value">${data.kpis.current.value}</p>
                    </div>
                    <p class="text-xs font-semibold flex items-center justify-center ${data.kpis.current.met ? 'text-green-600' : 'text-red-600'}">
                        ${data.kpis.current.met ? metIcon : notMetIcon}
                        ${data.kpis.current.met ? 'Cumplido' : 'Incumplido'}
                    </p>
                    <p class="text-xs text-gray-500">Obj: ${data.kpis.current.obj}</p>
                </div>`;
                 proposedKpiHtml = `
                <div class="kpi-card p-4 rounded-lg shadow-md text-center ${theme.kpiProposedBg} ${theme.kpiProposedBorder}">
                    <p class="text-gray-600 text-sm font-medium">${data.kpis.proposed.title || 'OBJETIVO'}</p>
                    <div class="my-1">
                        <p class="text-3xl font-bold ${theme.text} kpi-value">${data.kpis.proposed.value}</p>
                    </div>
                    <p class="text-xs text-gray-500">${data.kpis.proposed.year}</p>
                </div>`;
            }


            contentArea.innerHTML = `
                <header class="text-center mb-4">
                    <h1 class="text-3xl sm:text-4xl font-bold ${theme.text}">${data.name}</h1>
                    <p class="text-gray-600 mt-2">G.2024-2025 vs. Proyección G.2025-2026</p>
                </header>

                <div class="border-b border-gray-200 mb-8">
                    <nav class="-mb-px flex space-x-6" id="area-nav">
                        ${areaTabs}
                    </nav>
                </div>

                <section class="mb-12">
                    <h2 class="text-2xl font-semibold ${theme.text} mb-6 text-center">Costo Unitario (BS/KG)</h2>
                    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
                        ${pastKpisHtml}
                        ${currentKpiHtml}
                        ${proposedKpiHtml}
                    </div>
                </section>

                <section class="bg-white p-6 rounded-lg shadow-md mt-8 mb-8">
                    <div class="flex flex-wrap justify-between items-center mb-4 gap-4">
                        <div><h2 class="text-2xl font-semibold ${theme.text}">Pareto de Costos G.2024-2025</h2></div>
                        <button data-chart-type="cost" class="expandChartBtn bg-gray-700 text-white px-4 py-2 rounded-lg hover:bg-gray-600">Ampliar</button>
                    </div>
                    <div class="h-96"><canvas id="costParetoChart"></canvas></div>
                </section>

                <section class="bg-white p-6 rounded-lg shadow-md mt-8 mb-8">
                    <div class="flex flex-wrap justify-between items-center mb-4 gap-4">
                        <div><h2 class="text-2xl font-semibold ${theme.text}">Pareto de Variación Proyectada G.25-26 (Nominal)</h2></div>
                        <button data-chart-type="variation" class="expandChartBtn bg-gray-700 text-white px-4 py-2 rounded-lg hover:bg-gray-600">Ampliar</button>
                    </div>
                    <div class="h-96"><canvas id="variationParetoChart"></canvas></div>
                </section>

                <section class="bg-white p-6 rounded-lg shadow-md mt-8">
                    <h2 class="text-2xl font-semibold ${theme.text} mb-4">Premisas de Incremento en el Pareto</h2>
                    <ul class="list-disc list-inside text-gray-700 space-y-3 pl-2">${data.premises.map(p => `<li>${p}</li>`).join('')}</ul>
                </section>
            `;
            
            if (data.trendData) {
                const trendSection = `
                <section class="bg-white p-6 rounded-lg shadow-md mt-8 mb-8">
                    <div class="flex flex-wrap justify-between items-center mb-4 gap-4">
                        <div><h2 class="text-2xl font-semibold ${theme.text}">Tendencia de Costos vs. Kilos</h2></div>
                        <button data-chart-type="trend" class="expandChartBtn bg-gray-700 text-white px-4 py-2 rounded-lg hover:bg-gray-600">Ampliar</button>
                    </div>
                    <div class="h-96"><canvas id="trendChart"></canvas></div>
                </section>`;
                // Insert trend chart after KPIs
                const kpiSection = contentArea.querySelector('section');
                kpiSection.insertAdjacentHTML('afterend', trendSection);
                activeCharts.push(createTrendChart('trendChart', data.trendData, theme));
            }


            activeCharts.push(createCostParetoChart('costParetoChart', data.costs, theme));
            activeCharts.push(createVariationParetoChart('variationParetoChart', data.costs, theme));
            
            attachModalListeners(data.costs, theme, data.trendData);
            attachAreaTabListeners();
        }
        
        function createCostParetoChart(canvasId, costData, theme) {
            const sortedData = [...costData].sort((a, b) => b.value - a.value);
            const labels = sortedData.map(item => item.account);
            const dataValues = sortedData.map(item => item.value);
            const totalCost = dataValues.reduce((sum, value) => sum + value, 0);
            let cumulativePercentage = 0;
            const paretoData = dataValues.map(value => (cumulativePercentage += (value / totalCost) * 100));
            const ctx = document.getElementById(canvasId).getContext('2d');
            return new Chart(ctx, {
                type: 'bar',
                data: { labels, datasets: [{ label: 'Costo (Bs)', data: dataValues, backgroundColor: theme.chartBg, yAxisID: 'y' }, { label: 'Acumulado', data: paretoData, type: 'line', borderColor: theme.chartBorder, yAxisID: 'y1' }] },
                options: { responsive: true, maintainAspectRatio: false, scales: { x: { ticks: { autoSkip: false, maxRotation: 90, minRotation: 90, font: { size: 10 } } }, y: { type: 'linear', position: 'left', title: { display: true, text: 'Costo (Bs)' } }, y1: { type: 'linear', position: 'right', min: 0, max: 100, title: { display: true, text: 'Acumulado (%)' }, grid: { drawOnChartArea: false }, ticks: { callback: v => v.toFixed(0) + '%' } } }, plugins: { datalabels: {display: false}, tooltip: { callbacks: { label: c => `${c.dataset.label}: ${c.dataset.yAxisID === 'y1' ? c.parsed.y.toFixed(2) + '%' : c.parsed.y.toLocaleString('es-BO')}` } } } }
            });
        }

        function createVariationParetoChart(canvasId, costData, theme) {
            const variationsData = costData.map(item => ({ account: item.account, nominalVariation: item.projected_value - item.value, percentageVariation: item.value > 0 ? ((item.projected_value - item.value) / item.value) * 100 : 0 })).filter(item => item.nominalVariation > 0).sort((a, b) => b.nominalVariation - a.nominalVariation);
            const labels = variationsData.map(item => item.account);
            const nominalValues = variationsData.map(item => item.nominalVariation);
            const percentageValues = variationsData.map(item => item.percentageVariation);
            const totalNominalVariation = nominalValues.reduce((sum, value) => sum + value, 0);
            let cumulativePercentage = 0;
            const paretoData = nominalValues.map(value => (cumulativePercentage += (value / totalNominalVariation) * 100));
            const ctx = document.getElementById(canvasId).getContext('2d');
            return new Chart(ctx, {
                type: 'bar',
                data: { labels, datasets: [{ label: 'Variación (Bs)', data: nominalValues, backgroundColor: theme.chartBg, yAxisID: 'y' }, { label: 'Acumulado', data: paretoData, type: 'line', borderColor: theme.chartBorder, yAxisID: 'y1' }] },
                options: { responsive: true, maintainAspectRatio: false, scales: { x: { ticks: { autoSkip: false, maxRotation: 90, minRotation: 90, font: { size: 10 } } }, y: { type: 'linear', position: 'left', title: { display: true, text: 'Variación Nominal (Bs)' } }, y1: { type: 'linear', position: 'right', min: 0, max: 100, title: { display: true, text: 'Acumulado del Impacto Total (%)' }, grid: { drawOnChartArea: false }, ticks: { callback: v => v.toFixed(0) + '%' } } }, plugins: { datalabels: {display: false}, tooltip: { callbacks: { label: c => c.dataset.yAxisID === 'y1' ? `Acumulado: ${c.parsed.y.toFixed(2)}%` : `Var. Bs: ${nominalValues[c.dataIndex].toLocaleString('es-BO')} (Var. %: ${percentageValues[c.dataIndex].toFixed(2)}%)` } } } }
            });
        }
        
        function createTrendChart(canvasId, trendData, theme) {
            const ctx = document.getElementById(canvasId).getContext('2d');
            return new Chart(ctx, {
                type: 'line',
                data: {
                    labels: trendData.labels,
                    datasets: [
                        {
                            label: 'Costos T.',
                            data: trendData.costs,
                            borderColor: theme.chartBorder,
                            backgroundColor: theme.chartBg,
                            fill: false,
                            tension: 0.1
                        },
                        {
                            label: 'Kilos Proyectados en un crecimiento al 3% (Nivel Compañía)',
                            data: trendData.sales,
                            borderColor: 'rgb(255, 99, 132)',
                            backgroundColor: 'rgba(255, 99, 132, 0.2)',
                            fill: false,
                            tension: 0.1
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                           offset: true,
                           grid: {
                               offset: true
                           }
                        },
                        y: {
                            type: 'linear',
                            display: true,
                            position: 'left',
                            title: { display: true, text: 'Kilos & Costos' },
                             ticks: { 
                                 display: false
                             }
                        }
                    },
                    plugins: {
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    let label = context.dataset.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    label += parseInt(context.parsed.y).toLocaleString('es-BO');
                                    return label;
                                }
                            }
                        },
                        datalabels: {
                            anchor: 'end',
                            align: 'top',
                            offset: 4,
                            formatter: (value) => {
                                if (value > 1000000) {
                                    return (value / 1000000).toFixed(1) + 'M';
                                }
                                return (value / 1000).toFixed(0) + 'K';
                            },
                            font: {
                                weight: 'bold',
                            },
                            color: '#444'
                        }
                    }
                }
            });
        }


        const modal = document.getElementById('chartModal');
        const modalTitle = document.getElementById('modalTitle');
        const closeModalBtn = document.getElementById('closeModalBtn');
        
        function attachModalListeners(costData, theme, trendData) {
            document.querySelectorAll('.expandChartBtn').forEach(button => {
                button.addEventListener('click', (event) => {
                    const chartType = event.currentTarget.getAttribute('data-chart-type');
                    if (modalChartInstance) modalChartInstance.destroy();
                    modalTitle.className = `text-2xl font-semibold ${theme.text}`;
                    if (chartType === 'cost') {
                        modalTitle.textContent = 'Pareto de Costos G.2024-2025 (Ampliado)';
                        modalChartInstance = createCostParetoChart('modalChartCanvas', costData, theme);
                    } else if (chartType === 'variation') {
                        modalTitle.textContent = 'Pareto de Variación Proyectada G.25-26 (Ampliado)';
                        modalChartInstance = createVariationParetoChart('modalChartCanvas', costData, theme);
                    } else if (chartType === 'trend') {
                        modalTitle.textContent = 'Tendencia de Costos vs. Ventas (Ampliado)';
                        modalChartInstance = createTrendChart('modalChartCanvas', trendData, theme);
                    }
                    modal.style.display = 'flex';
                });
            });
        }
        
        closeModalBtn.addEventListener('click', () => modal.style.display = 'none');
        modal.addEventListener('click', (event) => { if (event.target === modal) modal.style.display = 'none'; });

        const sidebar = document.getElementById('sidebar');
        const mobileMenuButton = document.getElementById('mobile-menu-button');
        mobileMenuButton.addEventListener('click', () => {
            sidebar.classList.toggle('-translate-x-full');
        });

        document.querySelectorAll('#department-nav .nav-link').forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                document.querySelectorAll('#department-nav .nav-link').forEach(l => l.classList.remove('bg-gray-700'));
                e.currentTarget.classList.add('bg-gray-700');
                const deptKey = e.currentTarget.getAttribute('data-dept');
                const firstArea = Object.keys(departmentData[deptKey])[0];
                renderContent(deptKey, firstArea);
                if (window.innerWidth < 768) {
                    sidebar.classList.add('-translate-x-full');
                }
            });
        });

        function attachAreaTabListeners() {
            document.querySelectorAll('#area-nav .area-tab').forEach(tab => {
                tab.addEventListener('click', (e) => {
                    const areaKey = e.currentTarget.getAttribute('data-area');
                    renderContent(activeDept, areaKey);
                });
            });
        }

        document.querySelector('#department-nav .nav-link[data-dept="nacional"]').classList.add('bg-gray-700');
        renderContent('nacional', 'almacenaje');

    </script>
</body>
</html>
